
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Baseball &#8212; Modeling and Simulation in Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap22';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Optimal Baseball" href="chap23.html" />
    <link rel="prev" title="Drag" href="chap21.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Modeling and Simulation in Python</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Modeling and Simulation in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap01.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Bike Share System</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Sweeping Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">World Population</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">Proportional Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Limits to Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Projecting Population Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Analysis of Population Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Case Studies Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">Epidemiology</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap12.html">Modeling Vaccination</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Sweeping Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Nondimensionalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap15.html">Cooling Coffee</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap16.html">Adding Milk</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap17.html">Pharmacokinetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap18.html">Glucose and Insulin</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap19.html">Case Studies Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap20.html">The Empire State Building Strikes Back</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap21.html">Drag</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Baseball</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap23.html">Optimal Baseball</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap24.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap25.html">Torque</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap26.html">Case Studies Part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap27.html">Under the Hood</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="queue.html">One Queue or Two</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://allendowney.github.io/ModSimPy/api/index.html">API Documentation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ModSimPy" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap22.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Baseball</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Baseball</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-baseball-flight">Simulating Baseball Flight</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drag-force">Drag Force</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-event-function">Adding an Event Function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-trajectories">Visualizing Trajectories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-the-baseball">Animating the Baseball</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>Printed and electronic copies of <em>Modeling and Simulation in Python</em> are available from <a class="reference external" href="https://nostarch.com/modeling-and-simulation-python">No Starch Press</a> and <a class="reference external" href="https://bookshop.org/p/books/modeling-and-simulation-in-python-allen-b-downey/17836697?ean=9781718502161">Bookshop.org</a> and <a class="reference external" href="https://amzn.to/3y9UxNb">Amazon</a>.</p>
<section class="tex2jax_ignore mathjax_ignore" id="baseball">
<h1>Baseball<a class="headerlink" href="#baseball" title="Link to this heading">#</a></h1>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
Click here to access the notebooks: <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<p>In the previous chapter we modeled an object moving in one dimension, with and without drag. Now let’s move on to two dimensions, and baseball!</p>
<p>In this chapter we model the flight of a baseball including the effect
of air resistance. In the next chapter we use this model to solve an
optimization problem.</p>
<section id="id1">
<h2>Baseball<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>To model the flight of a baseball, we have to make some decisions. To get started, we’ll ignore any spin that might be on the ball, and the resulting Magnus force (see <a class="reference external" href="http://modsimpy.com/magnus">http://modsimpy.com/magnus</a>). Under this assumption, the ball travels in a vertical plane, so we’ll run simulations in two dimensions, rather than three.</p>
<p>To model air resistance, we’ll need the mass, frontal area, and drag
coefficient of a baseball. Mass and diameter are easy to find (see
<a class="reference external" href="http://modsimpy.com/baseball">http://modsimpy.com/baseball</a>). Drag coefficient is only a little
harder; according to <em>The Physics of Baseball</em> (see <a class="reference external" href="https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC">https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC</a>), the drag coefficient of a baseball is approximately 0.33 (with no units).</p>
<p>However, this value <em>does</em> depend on velocity. At low velocities it
might be as high as 0.5, and at high velocities as low as 0.28.
Furthermore, the transition between these values typically happens
exactly in the range of velocities we are interested in, between 20 m/s and 40 m/s.</p>
<p>Nevertheless, we’ll start with a simple model where the drag coefficient does not depend on velocity; as an exercise at the end of the chapter, you can implement a more detailed model and see what effect it has on the results.</p>
<p>But first we need a new computational tool, the <code class="docutils literal notranslate"><span class="pre">Vector</span></code> object.</p>
</section>
<section id="vectors">
<h2>Vectors<a class="headerlink" href="#vectors" title="Link to this heading">#</a></h2>
<p>Now that we are working in two dimensions, it will be useful to
work with <em>vector quantities</em>, that is, quantities that represent both a magnitude and a direction. We will use vectors to represent positions, velocities, accelerations, and forces in two and three dimensions.</p>
<p>ModSim provides a function called <code class="docutils literal notranslate"><span class="pre">Vector</span></code> that creates a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> that contains the <em>components</em> of the vector.
In a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> that represents a position in space, the components are the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates in 2-D, plus a <span class="math notranslate nohighlight">\(z\)</span> coordinate if the <code class="docutils literal notranslate"><span class="pre">Vector</span></code> is in 3-D.</p>
<p>You can create a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> by specifying its components. The following
<code class="docutils literal notranslate"><span class="pre">Vector</span></code> represents a point 3 units to the right (or east) and 4 units up (or north) from an implicit origin:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>3</td>
    </tr>
    <tr>
      <th>y</th>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can access the components of a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> by name using the dot
operator, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p>You can also access them by index using brackets, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Vector</span></code> objects support most mathematical operations, including
addition:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>4</td>
    </tr>
    <tr>
      <th>y</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And subtraction:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>2</td>
    </tr>
    <tr>
      <th>y</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For the definition and graphical interpretation of these operations, see <a class="reference external" href="http://modsimpy.com/vecops">http://modsimpy.com/vecops</a>.</p>
<p>We can specify a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> with coordinates <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, as in the previous examples.
Equivalently, we can specify a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> with a magnitude and angle.</p>
<p><em>Magnitude</em> is the length of the vector: if the <code class="docutils literal notranslate"><span class="pre">Vector</span></code> represents a position, magnitude is its distance from the origin; if it represents a velocity, magnitude is its speed.</p>
<p>The <em>angle</em> of a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> is its direction, expressed as an angle in radians from the positive <span class="math notranslate nohighlight">\(x\)</span> axis. In the Cartesian plane, the angle 0 rad is due east, and the angle <span class="math notranslate nohighlight">\(\pi\)</span> rad is due west.</p>
<p>ModSim provides functions to compute the magnitude and angle of a <code class="docutils literal notranslate"><span class="pre">Vector</span></code>.  For example, here are the magnitude and angle of <code class="docutils literal notranslate"><span class="pre">A</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mag</span> <span class="o">=</span> <span class="n">vector_mag</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">vector_angle</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">mag</span><span class="p">,</span> <span class="n">theta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5.0, 0.9272952180016122)
</pre></div>
</div>
</div>
</div>
<p>The magnitude is 5 because the length of <code class="docutils literal notranslate"><span class="pre">A</span></code> is the hypotenuse of a 3-4-5 triangle.</p>
<p>The result from <code class="docutils literal notranslate"><span class="pre">vector_angle</span></code> is in radians.
Most Python functions, like <code class="docutils literal notranslate"><span class="pre">sin</span></code> and <code class="docutils literal notranslate"><span class="pre">cos</span></code>, work with radians,
but many people find it more natural to work with degrees.
Fortunately, NumPy provides a function to convert radians to degrees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">rad2deg</span>

<span class="n">angle</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">angle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53.13010235415598
</pre></div>
</div>
</div>
</div>
<p>And a function to convert degrees to radians:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">deg2rad</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">theta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9272952180016122
</pre></div>
</div>
</div>
</div>
<p>To avoid confusion, I’ll use the variable name <code class="docutils literal notranslate"><span class="pre">angle</span></code> for a value in degrees and <code class="docutils literal notranslate"><span class="pre">theta</span></code> for a value in radians.</p>
<p>If you are given an angle and magnitude, you can make a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> using
<code class="docutils literal notranslate"><span class="pre">pol2cart</span></code>, which converts from polar to Cartesian coordinates. For example, here’s a new <code class="docutils literal notranslate"><span class="pre">Vector</span></code> with the same angle and magnitude of <code class="docutils literal notranslate"><span class="pre">A</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>y</th>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another way to represent the direction of <code class="docutils literal notranslate"><span class="pre">A</span></code> is a <em>unit vector</em>,
which is a vector with magnitude 1 that points in the same direction as
<code class="docutils literal notranslate"><span class="pre">A</span></code>. You can compute a unit vector by dividing a vector by its
magnitude:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">A</span> <span class="o">/</span> <span class="n">vector_mag</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>0.6</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>ModSim provides a function that does the same thing, called <code class="docutils literal notranslate"><span class="pre">vector_hat</span></code> because unit vectors are conventionally decorated with a hat, like this: <span class="math notranslate nohighlight">\(\hat{A}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_hat</span> <span class="o">=</span> <span class="n">vector_hat</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">A_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>0.6</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s get back to the game.</p>
</section>
<section id="simulating-baseball-flight">
<h2>Simulating Baseball Flight<a class="headerlink" href="#simulating-baseball-flight" title="Link to this heading">#</a></h2>
<p>Let’s simulate the flight of a baseball that is batted from home plate
at an angle of 45° and initial speed 40 m/s. We’ll use the center of home plate as the origin, a horizontal x-axis (parallel to the ground), and a vertical y-axis (perpendicular to the ground). The initial height is 1 m.</p>
<p>Here’s a <code class="docutils literal notranslate"><span class="pre">Params</span></code> object with the parameters we’ll need.</p>
<div class="cell tag_export docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">Params</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>          <span class="c1"># m</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>          <span class="c1"># m</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>     <span class="c1"># degree</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="c1"># m / s</span>

    <span class="n">mass</span> <span class="o">=</span> <span class="mf">145e-3</span><span class="p">,</span>    <span class="c1"># kg </span>
    <span class="n">diameter</span> <span class="o">=</span> <span class="mf">73e-3</span><span class="p">,</span> <span class="c1"># m </span>
    <span class="n">C_d</span> <span class="o">=</span> <span class="mf">0.33</span><span class="p">,</span>       <span class="c1"># dimensionless</span>

    <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>      <span class="c1"># kg/m**3</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.8</span><span class="p">,</span>        <span class="c1"># m/s**2</span>
    <span class="n">t_end</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>     <span class="c1"># s</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I got the mass and diameter of the baseball from Wikipedia (see <a class="reference external" href="https://en.wikipedia.org/wiki/Baseball_(ball)">https://en.wikipedia.org/wiki/Baseball_(ball)</a>) and the coefficient of drag from <em>The Physics of Baseball</em> (see <a class="reference external" href="https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC">https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC</a>):
The density of air, <code class="docutils literal notranslate"><span class="pre">rho</span></code>, is based on a temperature of 20 °C at sea level (see <a class="reference external" href="http://modsimpy.com/tempress">http://modsimpy.com/tempress</a>).
As usual, <code class="docutils literal notranslate"><span class="pre">g</span></code> is acceleration due to gravity.
<code class="docutils literal notranslate"><span class="pre">t_end</span></code> is 10 seconds, which is long enough for the ball to land on the ground.</p>
<p>The following function uses these quantities to make a <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
<div class="cell tag_export docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">deg2rad</span>

<span class="k">def</span> <span class="nf">make_system</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    
    <span class="c1"># convert angle to radians</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">deg2rad</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
    
    <span class="c1"># compute x and y components of velocity</span>
    <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    
    <span class="c1"># make the initial state</span>
    <span class="n">init</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">vx</span><span class="o">=</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="o">=</span><span class="n">vy</span><span class="p">)</span>
    
    <span class="c1"># compute the frontal area</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">diameter</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">return</span> <span class="n">System</span><span class="p">(</span><span class="n">params</span><span class="p">,</span>
                  <span class="n">init</span> <span class="o">=</span> <span class="n">init</span><span class="p">,</span>
                  <span class="n">area</span> <span class="o">=</span> <span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">make_system</span></code> uses <code class="docutils literal notranslate"><span class="pre">deg2rad</span></code> to convert <code class="docutils literal notranslate"><span class="pre">angle</span></code> to radians and
<code class="docutils literal notranslate"><span class="pre">pol2cart</span></code> to compute the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components of the initial
velocity.</p>
<p><code class="docutils literal notranslate"><span class="pre">init</span></code> is a <code class="docutils literal notranslate"><span class="pre">State</span></code> object with four state variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are the components of position.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vx</span></code> and <code class="docutils literal notranslate"><span class="pre">vy</span></code> are the components of velocity.</p></li>
</ul>
<p>When we call <code class="docutils literal notranslate"><span class="pre">System</span></code>, we pass <code class="docutils literal notranslate"><span class="pre">params</span></code> as the first argument, which means that the variables in <code class="docutils literal notranslate"><span class="pre">params</span></code> are copied to the new <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
<p>Here’s how we make the <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s the initial <code class="docutils literal notranslate"><span class="pre">State</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>y</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>vx</th>
      <td>28.284271</td>
    </tr>
    <tr>
      <th>vy</th>
      <td>28.284271</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="drag-force">
<h2>Drag Force<a class="headerlink" href="#drag-force" title="Link to this heading">#</a></h2>
<p>Next we need a function to compute drag force:</p>
<div class="cell tag_export docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drag_force</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">C_d</span><span class="p">,</span> <span class="n">area</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">C_d</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">area</span>
    
    <span class="n">mag</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">vector_mag</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C_d</span> <span class="o">*</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="n">vector_hat</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">f_drag</span> <span class="o">=</span> <span class="n">mag</span> <span class="o">*</span> <span class="n">direction</span>
    <span class="k">return</span> <span class="n">f_drag</span>
</pre></div>
</div>
</div>
</div>
<p>This function takes <code class="docutils literal notranslate"><span class="pre">V</span></code> as a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> and returns <code class="docutils literal notranslate"><span class="pre">f_drag</span></code> as a
<code class="docutils literal notranslate"><span class="pre">Vector</span></code>.</p>
<ul class="simple">
<li><p>It uses <code class="docutils literal notranslate"><span class="pre">vector_mag</span></code> to compute the magnitude of <code class="docutils literal notranslate"><span class="pre">V</span></code>,
and the drag equation to compute the magnitude of the drag force, <code class="docutils literal notranslate"><span class="pre">mag</span></code>.</p></li>
<li><p>Then it uses <code class="docutils literal notranslate"><span class="pre">vector_hat</span></code> to compute <code class="docutils literal notranslate"><span class="pre">direction</span></code>, which is a unit vector in the opposite direction of <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p></li>
<li><p>Finally, it computes the drag force vector by multiplying <code class="docutils literal notranslate"><span class="pre">mag</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code>.</p></li>
</ul>
<p>We can test it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">vy</span>
<span class="n">V_test</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
<span class="n">f_drag</span> <span class="o">=</span> <span class="n">drag_force</span><span class="p">(</span><span class="n">V_test</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">f_drag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>-0.937574</td>
    </tr>
    <tr>
      <th>y</th>
      <td>-0.937574</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> that represents the drag force on the baseball, in Newtons, under the initial conditions.</p>
<p>Now we can add drag to the slope function.</p>
<div class="cell tag_export docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slope_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">mass</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">g</span>
    
    <span class="n">V</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
    <span class="n">a_drag</span> <span class="o">=</span> <span class="n">drag_force</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span> <span class="o">/</span> <span class="n">mass</span>
    <span class="n">a_grav</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">A</span> <span class="o">=</span> <span class="n">a_grav</span> <span class="o">+</span> <span class="n">a_drag</span>
    
    <span class="k">return</span> <span class="n">V</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>As usual, the parameters of the slope function are a time stamp, a <code class="docutils literal notranslate"><span class="pre">State</span></code> object, and a <code class="docutils literal notranslate"><span class="pre">System</span></code> object.
We don’t use <code class="docutils literal notranslate"><span class="pre">t</span></code> in this example, but we can’t leave it out because when <code class="docutils literal notranslate"><span class="pre">run_solve_ivp</span></code> calls the slope function, it always provides the same arguments, whether they are needed or not.</p>
<p><code class="docutils literal notranslate"><span class="pre">slope_func</span></code> unpacks the <code class="docutils literal notranslate"><span class="pre">State</span></code> object into variables <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">vx</span></code>, and <code class="docutils literal notranslate"><span class="pre">vy</span></code>.
Then it packs <code class="docutils literal notranslate"><span class="pre">vx</span></code> and <code class="docutils literal notranslate"><span class="pre">vy</span></code> into a <code class="docutils literal notranslate"><span class="pre">Vector</span></code>, which it uses to compute acceleration due to drag, <code class="docutils literal notranslate"><span class="pre">a_drag</span></code>.</p>
<p>To represent acceleration due to gravity, it makes a <code class="docutils literal notranslate"><span class="pre">Vector</span></code> with magnitude <code class="docutils literal notranslate"><span class="pre">g</span></code> in the negative <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>The total acceleration of the baseball, <code class="docutils literal notranslate"><span class="pre">A</span></code>, is the sum of accelerations due to gravity and drag.</p>
<p>The return value is a sequence that contains:</p>
<ul class="simple">
<li><p>The components of velocity, <code class="docutils literal notranslate"><span class="pre">V.x</span></code> and <code class="docutils literal notranslate"><span class="pre">V.y</span></code>.</p></li>
<li><p>The components of acceleration, <code class="docutils literal notranslate"><span class="pre">A.x</span></code> and <code class="docutils literal notranslate"><span class="pre">A.y</span></code>.</p></li>
</ul>
<p>These components represent the slope of the state variables, because <code class="docutils literal notranslate"><span class="pre">V</span></code> is the derivative of position and <code class="docutils literal notranslate"><span class="pre">A</span></code> is the derivative of velocity.</p>
<p>As always, we can test the slope function by running it with the initial conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(28.284271247461902, 28.2842712474619, -6.466030881564545, -16.266030881564546)
</pre></div>
</div>
</div>
</div>
<p>Using vectors to represent forces and accelerations makes the code
concise, readable, and less error-prone. In particular, when we add
<code class="docutils literal notranslate"><span class="pre">a_grav</span></code> and <code class="docutils literal notranslate"><span class="pre">a_drag</span></code>, the directions are likely to be correct, because they are encoded in the <code class="docutils literal notranslate"><span class="pre">Vector</span></code> objects.</p>
</section>
<section id="adding-an-event-function">
<h2>Adding an Event Function<a class="headerlink" href="#adding-an-event-function" title="Link to this heading">#</a></h2>
<p>We’re almost ready to run the simulation.  The last thing we need is an event function that stops when the ball hits the ground.</p>
<div class="cell tag_export docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">event_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>The event function takes the same parameters as the slope function, and returns the <span class="math notranslate nohighlight">\(y\)</span> coordinate of position. When the <span class="math notranslate nohighlight">\(y\)</span> coordinate passes through 0, the simulation stops.</p>
<p>As we did with <code class="docutils literal notranslate"><span class="pre">slope_func</span></code>, we can test <code class="docutils literal notranslate"><span class="pre">event_func</span></code> with the initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Here’s how we run the simulation with this event function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span>
                                 <span class="n">events</span><span class="o">=</span><span class="n">event_func</span><span class="p">)</span>
<span class="n">details</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</div>
<p>The message indicates that a “termination event” occurred; that is, the simulated ball reached the ground.</p>
<p><code class="docutils literal notranslate"><span class="pre">results</span></code> is a <code class="docutils literal notranslate"><span class="pre">TimeFrame</span></code> with one row for each time step and one column for each of the state variables.
Here are the last few rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>vx</th>
      <th>vy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4.804692</th>
      <td>96.438515</td>
      <td>4.284486</td>
      <td>14.590855</td>
      <td>-20.726780</td>
    </tr>
    <tr>
      <th>4.854740</th>
      <td>97.166460</td>
      <td>3.238415</td>
      <td>14.484772</td>
      <td>-21.065476</td>
    </tr>
    <tr>
      <th>4.904789</th>
      <td>97.889087</td>
      <td>2.175515</td>
      <td>14.378566</td>
      <td>-21.400392</td>
    </tr>
    <tr>
      <th>4.954838</th>
      <td>98.606374</td>
      <td>1.095978</td>
      <td>14.272264</td>
      <td>-21.731499</td>
    </tr>
    <tr>
      <th>5.004887</th>
      <td>99.318296</td>
      <td>0.000000</td>
      <td>14.165894</td>
      <td>-22.058763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can get the flight time like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flight_time</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">flight_time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.004887034868346
</pre></div>
</div>
</div>
</div>
<p>And the final state like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_state</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">show</span><span class="p">(</span><span class="n">final_state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>5.004887</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>99.318296</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>vx</th>
      <td>14.165894</td>
    </tr>
    <tr>
      <th>vy</th>
      <td>-22.058763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The final value of <code class="docutils literal notranslate"><span class="pre">y</span></code> is close to 0, as it should be.  The final value of <code class="docutils literal notranslate"><span class="pre">x</span></code> tells us how far the ball flew, in meters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_dist</span> <span class="o">=</span> <span class="n">final_state</span><span class="o">.</span><span class="n">x</span>
<span class="n">x_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.31829628352207
</pre></div>
</div>
</div>
</div>
<p>We can also get the final velocity, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_V</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">final_state</span><span class="o">.</span><span class="n">vy</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">final_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>14.165894</td>
    </tr>
    <tr>
      <th>y</th>
      <td>-22.058763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The magnitude of final velocity is the speed of the ball when it lands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vector_mag</span><span class="p">(</span><span class="n">final_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26.215674453237572
</pre></div>
</div>
</div>
</div>
<p>The final speed is about 26 m/s, which is substantially slower than the initial speed, 40 m/s.</p>
</section>
<section id="visualizing-trajectories">
<h2>Visualizing Trajectories<a class="headerlink" href="#visualizing-trajectories" title="Link to this heading">#</a></h2>
<p>To visualize the results, we can plot the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components of position like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Position (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/78a9aee4882cafd99289bd18a0ef60dd30aca8260540645fb044e20db5c4bb2b.png" src="_images/78a9aee4882cafd99289bd18a0ef60dd30aca8260540645fb044e20db5c4bb2b.png" />
</div>
</div>
<p>As expected, the <span class="math notranslate nohighlight">\(x\)</span> component increases as the ball moves away from home plate. The <span class="math notranslate nohighlight">\(y\)</span> position climbs initially and then descends, falling to 0 m near 5.0 s.</p>
<p>Another way to view the results is to plot the <span class="math notranslate nohighlight">\(x\)</span> component on the
<span class="math notranslate nohighlight">\(x\)</span>-axis and the <span class="math notranslate nohighlight">\(y\)</span> component on the <span class="math notranslate nohighlight">\(y\)</span>-axis, so the plotted line follows the trajectory of the ball through the plane:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_trajectory</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span>
    <span class="n">make_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;trajectory&#39;</span><span class="p">)</span>

    <span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x position (m)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y position (m)&#39;</span><span class="p">)</span>

<span class="n">plot_trajectory</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9883c1be08cafb3735aee8a8a7b95ad1d442de7da4ad23ad73349dc9cf21b4fd.png" src="_images/9883c1be08cafb3735aee8a8a7b95ad1d442de7da4ad23ad73349dc9cf21b4fd.png" />
</div>
</div>
<p>This way of visualizing the results is called a <em>trajectory plot</em> (see <a class="reference external" href="http://modsimpy.com/trajec">http://modsimpy.com/trajec</a>).
A trajectory plot can be easier to interpret than a time series plot,
because it shows what the motion of the projectile would look like (at
least from one point of view). Both plots can be useful, but don’t get
them mixed up! If you are looking at a time series plot and interpreting it as a trajectory, you will be very confused.</p>
<p>Notice that the trajectory is not symmetric.
With a launch angle of 45°, the landing angle is closer to vertical, about 57° degrees.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rad2deg</span><span class="p">(</span><span class="n">vector_angle</span><span class="p">(</span><span class="n">final_V</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-57.29187097821225
</pre></div>
</div>
</div>
</div>
</section>
<section id="animating-the-baseball">
<h2>Animating the Baseball<a class="headerlink" href="#animating-the-baseball" title="Link to this heading">#</a></h2>
<p>One of the best ways to visualize the results of a physical model is animation.  If there are problems with the model, animation can make them apparent.</p>
<p>The ModSimPy library provides <code class="docutils literal notranslate"><span class="pre">animate</span></code>, which takes as parameters a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> and a draw function.
The draw function should take as parameters a time stamp and a <code class="docutils literal notranslate"><span class="pre">State</span></code>.  It should draw a single frame of the animation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">plot</span>

<span class="n">xlim</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">results</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">draw_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
    <span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x position (m)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y position (m)&#39;</span><span class="p">,</span>
             <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
             <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Inside the draw function, you should use <code class="docutils literal notranslate"><span class="pre">decorate</span></code> to set the limits of the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes.
Otherwise <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> auto-scales the axes, which is usually not what you want.</p>
<p>Now we can run the animation like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">animate</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">draw_func</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see the results when you run the code from this chapter.</p>
<p>To run the animation, uncomment the following line of code and run the cell.</p>
<div class="cell tag_remove-print docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># animate(results, draw_func)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>This chapter introduces <code class="docutils literal notranslate"><span class="pre">Vector</span></code> objects, which we use to represent position, velocity, and acceleration in two dimensions.
We also represent forces using vectors, which make it easier to add up forces acting in different directions.</p>
<p>Our ODE solver doesn’t work with <code class="docutils literal notranslate"><span class="pre">Vector</span></code> objects, so it takes some work to pack and unpack their components.
Nevertheless, we were able to run simulations with vectors and display the results.</p>
<p>In the next chapter we’ll use these simulations to solve an optimization problem.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
You can access the notebooks at <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>Run the simulation with and without air resistance.  How wrong would we be if we ignored drag?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hint</span>

<span class="n">system2</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">C_d</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">results2</span><span class="p">,</span> <span class="n">details2</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system2</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func</span><span class="p">)</span>
<span class="n">details</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">plot_trajectory</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">plot_trajectory</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/623b4673033b845aae25e324c43986cc1a35a08de1b0eb692bc37ae077f5d276.png" src="_images/623b4673033b845aae25e324c43986cc1a35a08de1b0eb692bc37ae077f5d276.png" />
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">x_dist2</span> <span class="o">=</span> <span class="n">results2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
<span class="n">x_dist2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>164.2592550241319
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">x_dist2</span> <span class="o">-</span> <span class="n">x_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64.94095874060983
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>The baseball stadium in Denver, Colorado is 1,580 meters above sea level, where the density of air is about 1.0 kg / m<span class="math notranslate nohighlight">\(^3\)</span>.  Compared with the example near sea level, how much farther would a ball travel if hit with the same initial speed and launch angle?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hint</span>

<span class="n">system3</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">results3</span><span class="p">,</span> <span class="n">details3</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system3</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func</span><span class="p">)</span>

<span class="n">x_dist3</span> <span class="o">=</span> <span class="n">results3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
<span class="n">x_dist3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>105.78838005859785
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">x_dist3</span> <span class="o">-</span> <span class="n">x_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.4700837750757785
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<p>The model so far is based on the assumption that coefficient of drag does not depend on velocity, but in reality it does.  The following figure, from Adair, <em>The Physics of Baseball</em>, shows coefficient of drag as a function of velocity (see <a class="reference external" href="https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC">https://books.google.com/books/about/The_Physics_of_Baseball.html?id=4xE4Ngpk_2EC</a>).</p>
<p><img alt="Graph of drag coefficient versus velocity" src="https://github.com/AllenDowney/ModSimPy/raw/master/figs/baseball_drag.png" /></p>
<p>I used an online graph digitizer (<a class="reference external" href="https://automeris.io/WebPlotDigitizer">https://automeris.io/WebPlotDigitizer</a>) to extract the data and save it in a CSV file.</p>
<p>Here’s what it looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_d_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$C_d$&#39;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Speed (m/s)&#39;</span><span class="p">,</span> 
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Coefficient of drag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c6f16b7effcfd8acda4fc9e30b651f28209843ed1deadcd69a042d4b5b02f147.png" src="_images/c6f16b7effcfd8acda4fc9e30b651f28209843ed1deadcd69a042d4b5b02f147.png" />
</div>
</div>
<p>Modify the model to include the dependence of <code class="docutils literal notranslate"><span class="pre">C_d</span></code> on velocity, and see how much it affects the results.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="k">def</span> <span class="nf">drag_force2</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">area</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">area</span>
    
    <span class="n">C_d</span> <span class="o">=</span> <span class="n">drag_interp</span><span class="p">(</span><span class="n">vector_mag</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="o">-</span><span class="n">rho</span> <span class="o">*</span> <span class="n">vector_mag</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C_d</span> <span class="o">*</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="n">vector_hat</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">f_drag</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">mag</span>
    <span class="k">return</span> <span class="n">f_drag</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="k">def</span> <span class="nf">slope_func2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">mass</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">g</span>
    
    <span class="n">V</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
    <span class="n">a_drag</span> <span class="o">=</span> <span class="n">drag_force2</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span> <span class="o">/</span> <span class="n">mass</span>
    <span class="n">a_grav</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">A</span> <span class="o">=</span> <span class="n">a_grav</span> <span class="o">+</span> <span class="n">a_drag</span>
    
    <span class="k">return</span> <span class="n">V</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">system4</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">f_drag</span> <span class="o">=</span> <span class="n">drag_force</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">system4</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">f_drag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>-1.054771</td>
    </tr>
    <tr>
      <th>y</th>
      <td>-1.054771</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">slope_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system4</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(28.284271247461902, 28.2842712474619, -6.466030881564545, -16.266030881564546)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">results4</span><span class="p">,</span> <span class="n">details4</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system4</span><span class="p">,</span> <span class="n">slope_func2</span><span class="p">,</span> 
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func</span><span class="p">)</span>
<span class="n">details4</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">results4</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>vx</th>
      <th>vy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4.722631</th>
      <td>87.869695</td>
      <td>3.989943e+00</td>
      <td>12.094833</td>
      <td>-19.677696</td>
    </tr>
    <tr>
      <th>4.771825</th>
      <td>88.462327</td>
      <td>3.013834e+00</td>
      <td>11.980462</td>
      <td>-19.973270</td>
    </tr>
    <tr>
      <th>4.821019</th>
      <td>89.049363</td>
      <td>2.023337e+00</td>
      <td>11.866567</td>
      <td>-20.265039</td>
    </tr>
    <tr>
      <th>4.870213</th>
      <td>89.630803</td>
      <td>1.018656e+00</td>
      <td>11.753207</td>
      <td>-20.553016</td>
    </tr>
    <tr>
      <th>4.919407</th>
      <td>90.206647</td>
      <td>1.065814e-14</td>
      <td>11.640440</td>
      <td>-20.837214</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">x_dist4</span> <span class="o">=</span> <span class="n">results4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
<span class="n">x_dist4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90.20664656623305
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Taking into account variation in C_d, the ball</span>
<span class="c1"># would travel about 9 m less far.</span>

<span class="n">x_dist4</span> <span class="o">-</span> <span class="n">x_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-9.111649717289026
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap21.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Drag</p>
      </div>
    </a>
    <a class="right-next"
       href="chap23.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Optimal Baseball</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Baseball</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-baseball-flight">Simulating Baseball Flight</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drag-force">Drag Force</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-event-function">Adding an Event Function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-trajectories">Visualizing Trajectories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-the-baseball">Animating the Baseball</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>