
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Case Studies Part 2 &#8212; Modeling and Simulation in Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Empire State Building Strikes Back" href="chap20.html" />
    <link rel="prev" title="Glucose and Insulin" href="chap18.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Modeling and Simulation in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Modeling and Simulation in Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap01.html">
   Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap02.html">
   Bike Share System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap03.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap04.html">
   Sweeping Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap05.html">
   World Population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap06.html">
   Proportional Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap07.html">
   Limits to Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap08.html">
   Projecting Population Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap09.html">
   Analysis of Population Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Case Studies Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Epidemiology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Modeling Vaccination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Sweeping Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap14.html">
   Nondimensionalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Cooling Coffee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap16.html">
   Adding Milk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap17.html">
   Pharmacokinetics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap18.html">
   Glucose and Insulin
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Case Studies Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap20.html">
   The Empire State Building Strikes Back
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap21.html">
   Drag
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap22.html">
   Baseball
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap23.html">
   Optimal Baseball
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap24.html">
   Rotation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap25.html">
   Torque
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap26.html">
   Case Studies Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap27.html">
   Under the Hood
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AllenDowney/ModSimPy/master?urlpath=tree/chap19.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/AllenDowney/ModSimPy"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/chap19.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-glucose-minimal-model">
   The Glucose Minimal Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-insulin-minimal-model">
   The Insulin Minimal Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#low-pass-filter">
   Low-pass Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thermal-behavior-of-a-wall">
   Thermal Behavior of a Wall
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hiv">
   HIV
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Case Studies Part 2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-glucose-minimal-model">
   The Glucose Minimal Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-insulin-minimal-model">
   The Insulin Minimal Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#low-pass-filter">
   Low-pass Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thermal-behavior-of-a-wall">
   Thermal Behavior of a Wall
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hiv">
   HIV
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="case-studies-part-2">
<h1>Case Studies Part 2<a class="headerlink" href="#case-studies-part-2" title="Permalink to this headline">#</a></h1>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
Click here to access the notebooks: <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<p>This chapter presents case studies where you can apply the tools we have learned so far to the glucose-insulin minimal model, an electronic circuit, a thermal model of a wall, and the interaction of HIV and T cells.</p>
<section id="the-glucose-minimal-model">
<h2>The Glucose Minimal Model<a class="headerlink" href="#the-glucose-minimal-model" title="Permalink to this headline">#</a></h2>
<p>In the previous chapter we implemented the glucose minimal model using given parameters, but I didn’t say where those parameters came from.</p>
<p>In the repository for this book, you will find a notebook,
<em>glucose.ipynb</em>, that shows how we can find the parameters that best fit the data.
You can download it from <a class="reference external" href="https://github.com/AllenDowney/ModSimPy/raw/master/examples/glucose.ipynb">https://github.com/AllenDowney/ModSimPy/raw/master/examples/glucose.ipynb</a> or run it on Colab at <a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/glucose.ipynb">https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/glucose.ipynb</a>.</p>
<p>It uses a SciPy function called <code class="docutils literal notranslate"><span class="pre">leastsq</span></code>, which stands for “least squares”; so-named because it finds the parameters that minimize the sum of squared differences between the results of the model and the data.</p>
<p>You can think of <code class="docutils literal notranslate"><span class="pre">leastsq</span></code> as an optional tool for this book.  We won’t use it in the text itself, but it appears in a few of the case studies.</p>
</section>
<section id="the-insulin-minimal-model">
<h2>The Insulin Minimal Model<a class="headerlink" href="#the-insulin-minimal-model" title="Permalink to this headline">#</a></h2>
<p>Along with the glucose minimal model, Berman et al. developed an insulin minimal model, in which the concentration of insulin, <span class="math notranslate nohighlight">\(I\)</span>, is governed by this differential equation:</p>
<div class="math notranslate nohighlight">
\[\frac{dI}{dt} = -k I(t) + \gamma \left[ G(t) - G_T \right] t\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span> is a parameter that controls the rate of insulin disappearance
independent of blood glucose.</p></li>
<li><p><span class="math notranslate nohighlight">\(G(t)\)</span> is the measured concentration of blood glucose at time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(G_T\)</span> is the glucose threshold; when blood glucose is above this
level, it triggers an increase in blood insulin.</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span> is a parameter that controls the rate of increase (or
decrease) in blood insulin when glucose is above (or below) <span class="math notranslate nohighlight">\(G_T\)</span>.</p></li>
</ul>
<p>The initial condition is <span class="math notranslate nohighlight">\(I(0) = I_0\)</span>. As in the glucose minimal model, we treat this initial concentration as a free parameter; that is, we’ll choose it to fit the data.</p>
<p>The parameters of this model can be used to estimate <span class="math notranslate nohighlight">\(\phi_1\)</span> and
<span class="math notranslate nohighlight">\(\phi_2\)</span>, which are quantities that “describe the sensitivity to glucose of the first and second phase pancreatic responsivity”. These quantities are related to the parameters as follows:</p>
<div class="math notranslate nohighlight">
\[\phi_1 = \frac{I_{max} - I_b}{k (G_0 - G_b)}\]</div>
<div class="math notranslate nohighlight">
\[\phi_2 = \gamma \times 10^4\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{max}\)</span> is the maximum measured insulin level, and <span class="math notranslate nohighlight">\(I_b\)</span> and <span class="math notranslate nohighlight">\(G_b\)</span> are the basal levels of insulin and glucose.</p>
<p>In the repository for this book, you will find a notebook,
<em>insulin.ipynb</em>, that contains starter code for this case study. Use it to implement the insulin model, find the parameters that best fit the data, and estimate <span class="math notranslate nohighlight">\(\phi_1\)</span> and <span class="math notranslate nohighlight">\(\phi_2\)</span>.
You can download it from <a class="reference external" href="https://github.com/AllenDowney/ModSimPy/raw/master/examples/insulin.ipynb">https://github.com/AllenDowney/ModSimPy/raw/master/examples/insulin.ipynb</a> or run it on Colab at <a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/insulin.ipynb">https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/insulin.ipynb</a>.</p>
</section>
<section id="low-pass-filter">
<h2>Low-pass Filter<a class="headerlink" href="#low-pass-filter" title="Permalink to this headline">#</a></h2>
<p>The following circuit diagram (from <a class="reference external" href="https://commons.wikimedia.org/wiki/File:1st_Order_Lowpass_Filter_RC.svg">https://commons.wikimedia.org/wiki/File:1st_Order_Lowpass_Filter_RC.svg</a>) shows a low-pass filter built with one resistor and one capacitor.</p>
<p><img alt="Circuit diagram of a low-pass filter" src="https://github.com/AllenDowney/ModSim/raw/main/figs/Lowpass_Filter_RC.png" /></p>
<p>A <em>filter</em> is a circuit that takes a signal, <span class="math notranslate nohighlight">\(V_{in}\)</span>, as input and produces a signal, <span class="math notranslate nohighlight">\(V_{out}\)</span>, as output. In this context, a <em>signal</em> is a voltage that changes over time.</p>
<p>A filter is <em>low-pass</em> if it allows low-frequency signals to pass from
<span class="math notranslate nohighlight">\(V_{in}\)</span> to <span class="math notranslate nohighlight">\(V_{out}\)</span> unchanged, but it reduces the amplitude of
high-frequency signals.</p>
<p>By applying the laws of circuit analysis, we can derive a differential
equation that describes the behavior of this system. By solving the
differential equation, we can predict the effect of this circuit on any input signal.</p>
<p>Suppose we are given <span class="math notranslate nohighlight">\(V_{in}\)</span> and <span class="math notranslate nohighlight">\(V_{out}\)</span> at a particular instant in
time. By Ohm’s law, which is a simple model of the behavior of
resistors, the instantaneous current through the resistor is:</p>
<div class="math notranslate nohighlight">
\[I_R = (V_{in} - V_{out}) / R\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is resistance in ohms (<span class="math notranslate nohighlight">\(\Omega\)</span>).</p>
<p>Assuming that no current flows through the output of the circuit,
Kirchhoff’s current law implies that the current through the capacitor
is:</p>
<div class="math notranslate nohighlight">
\[I_C = I_R\]</div>
<p>According to a simple model of the behavior of
capacitors, current through the capacitor causes a change in the voltage across the capacitor:</p>
<div class="math notranslate nohighlight">
\[I_C = C \frac{d V_{out}}{dt}\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is capacitance in farads (F). Combining these equations yields a differential equation for <span class="math notranslate nohighlight">\(V_{out}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{d V_{out}}{dt} = \frac{V_{in} - V_{out}}{R C}\]</div>
<p>In the repository for this book, you will find a notebook, <em>filter.ipynb</em>, which contains starter code for this case study. You can download it from <a class="reference external" href="https://github.com/AllenDowney/ModSimPy/raw/master/examples/filter.ipynb">https://github.com/AllenDowney/ModSimPy/raw/master/examples/filter.ipynb</a> or run it on Colab at <a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/filter.ipynb">https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/filter.ipynb</a>.
Follow the instructions to simulate the low-pass filter for input signals like this:</p>
<div class="math notranslate nohighlight">
\[V_{in}(t) = A \cos (2 \pi f t)\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the amplitude of the input signal, say 5 V, and <span class="math notranslate nohighlight">\(f\)</span> is the frequency of the signal in Hz.</p>
</section>
<section id="thermal-behavior-of-a-wall">
<h2>Thermal Behavior of a Wall<a class="headerlink" href="#thermal-behavior-of-a-wall" title="Permalink to this headline">#</a></h2>
<p>This case study is based on a paper that models the thermal behavior of a brick wall with the goal of understanding the “performance gap between the expected energy use of buildings and their measured energy use”.</p>
<p>The following figure shows the scenario and their model of the wall:</p>
<p><img alt="Model of a wall as a series of thermal insulators" src="https://github.com/AllenDowney/ModSim/raw/main/figs/wall_model.png" /></p>
<p>On the interior and exterior surfaces of the wall, they measure
temperature and heat flux (rate of heat flow) over a period of three days. They model the wall using two thermal masses connected to the surfaces, and to each other, by thermal resistors.</p>
<p>The primary methodology of the paper is a statistical method for inferring the parameters of the system (two thermal masses and three thermal resistances).</p>
<p>The primary result is a comparison of two models: the one shown here with two thermal masses, and a simpler model with only one thermal mass. They find that the two-mass model is able to reproduce the measured fluxes substantially better.</p>
<p>For this case study we will implement their model and run it with the
estimated parameters from the paper, and then use <code class="docutils literal notranslate"><span class="pre">leastsq</span></code> to see
if we can find parameters that yield lower errors.</p>
<p>In the repository for this book, you will find a notebook, <em>wall.ipynb</em> with the code and results for this case study.
You can download it from <a class="reference external" href="https://github.com/AllenDowney/ModSimPy/raw/master/examples/wall.ipynb">https://github.com/AllenDowney/ModSimPy/raw/master/examples/wall.ipynb</a> or run it on Colab at <a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/wall.ipynb">https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/wall.ipynb</a>.</p>
<p>The paper this case study is based on is
Gori, Marincioni, Biddulph, Elwell, “Inferring the thermal resistance and effective thermal mass distribution of a wall from in situ measurements to characterise heat transfer at both the interior and exterior surfaces”, <em>Energy and Buildings</em>, 2017, available from <a class="reference external" href="http://modsimpy.com/wall2">http://modsimpy.com/wall2</a>.</p>
<p>The authors put their paper under a Creative Commons license and made their data available at <a class="reference external" href="http://modsimpy.com/wall">http://modsimpy.com/wall</a>. I thank them for their commitment to open, reproducible science, which made this case study possible.</p>
</section>
<section id="hiv">
<h2>HIV<a class="headerlink" href="#hiv" title="Permalink to this headline">#</a></h2>
<p>During the initial phase of HIV infection, the concentration of the virus in the bloodstream typically increases quickly and then decreases.
The most obvious explanation for the decline is an immune response that destroys the virus or controls its replication.
However, at least in some patients, the decline occurs even without any detectable immune response.</p>
<p>In 1996 Andrew Phillips proposed another explanation for the decline in this paper: “Reduction of HIV Concentration During Acute Infection: Independence from a Specific Immune Response”, available from <a class="reference external" href="https://people.math.gatech.edu/~weiss/uploads/5/8/6/1/58618765/phillips1996.pdf">https://people.math.gatech.edu/~weiss/uploads/5/8/6/1/58618765/phillips1996.pdf</a>).</p>
<p>Phillips presents a system of differential equations that models the concentrations of the HIV virus and the CD4 cells it infects.
The model does not include an immune response; nevertheless, it demonstrates behavior that is qualitatively similar to what is seen in patients during the first few weeks after infection.</p>
<p>His conclusion is that the observed decline in the concentration of HIV might not be caused by an immune response; it could be due to the dynamic interaction between HIV and the cells it infects.</p>
<p>In the repository for this book, you will find a notebook, <em>hiv_model.ipynb</em>, which you can use to implement Phillips’s model and consider whether it does the work it is meant to do.
You can download it from <a class="reference external" href="https://github.com/AllenDowney/ModSimPy/raw/master/examples/hiv_model.ipynb">https://github.com/AllenDowney/ModSimPy/raw/master/examples/hiv_model.ipynb</a> or run it on Colab at <a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/hiv_model.ipynb">https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master/examples/hiv_model.ipynb</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chap18.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Glucose and Insulin</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chap20.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Empire State Building Strikes Back</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Allen B. Downey<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>