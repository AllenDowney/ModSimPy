
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Adding Milk &#8212; Modeling and Simulation in Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap16';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pharmacokinetics" href="chap17.html" />
    <link rel="prev" title="Cooling Coffee" href="chap15.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Modeling and Simulation in Python</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Modeling and Simulation in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap01.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Bike Share System</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Sweeping Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">World Population</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">Proportional Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Limits to Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Projecting Population Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Analysis of Population Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Case Studies Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">Epidemiology</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap12.html">Modeling Vaccination</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Sweeping Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Nondimensionalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap15.html">Cooling Coffee</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Adding Milk</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap17.html">Pharmacokinetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap18.html">Glucose and Insulin</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap19.html">Case Studies Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap20.html">The Empire State Building Strikes Back</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap21.html">Drag</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap22.html">Baseball</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap23.html">Optimal Baseball</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap24.html">Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap25.html">Torque</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap26.html">Case Studies Part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap27.html">Under the Hood</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="queue.html">One Queue or Two</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ModSimPy" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap16.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Adding Milk</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-liquids">Mixing Liquids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-first-or-last">Mix First or Last?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimal-timing">Optimal Timing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytic-solution">Analytic Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>Printed and electronic copies of <em>Modeling and Simulation in Python</em> are available from <a class="reference external" href="https://nostarch.com/modeling-and-simulation-python">No Starch Press</a> and <a class="reference external" href="https://bookshop.org/p/books/modeling-and-simulation-in-python-allen-b-downey/17836697?ean=9781718502161">Bookshop.org</a> and <a class="reference external" href="https://amzn.to/3y9UxNb">Amazon</a>.</p>
<section class="tex2jax_ignore mathjax_ignore" id="adding-milk">
<h1>Adding Milk<a class="headerlink" href="#adding-milk" title="Link to this heading">#</a></h1>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
Click here to access the notebooks: <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<p>In the previous chapter we wrote a simulation of a cooling cup of
coffee.
Given the initial temperature of the coffee, the temperature of the atmosphere, and the rate parameter, <code class="docutils literal notranslate"><span class="pre">r</span></code>, we predicted the temperature of the coffee over time.
Then we used a root finding algorithm to estimate <code class="docutils literal notranslate"><span class="pre">r</span></code> based on data.</p>
<p>If you did the exercises, you simulated the temperature of the milk as it warmed, and estimated its rate parameter as well.</p>
<p>Now let’s put it together.
In this chapter we’ll write a function that simulates mixing the two liquids, and use it to answer the question we started with: is it better to mix the coffee and milk at the beginning, the end, or somewhere in the middle?</p>
<section id="mixing-liquids">
<h2>Mixing Liquids<a class="headerlink" href="#mixing-liquids" title="Link to this heading">#</a></h2>
<p>When we mix two liquids, the temperature of the mixture depends on the
temperatures of the ingredients as well as their volumes, densities, and specific heat capacities (as defined in the previous chapter).
In this section I’ll explain how.</p>
<p>Assuming there are no chemical reactions that either produce or consume heat, the total thermal energy of the system is the same before and after mixing; in other words, thermal energy is <em>conserved</em>.</p>
<p>If the temperature of the first liquid is <span class="math notranslate nohighlight">\(T_1\)</span>, the temperature of the second liquid is <span class="math notranslate nohighlight">\(T_2\)</span>, and the final temperature of the mixture is <span class="math notranslate nohighlight">\(T\)</span>, the heat transfer into the first liquid is <span class="math notranslate nohighlight">\(C_1 (T - T_1)\)</span> and the heat transfer into the second liquid is <span class="math notranslate nohighlight">\(C_2 (T - T_2)\)</span>, where <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> are the thermal masses of the liquids.</p>
<p>In order to conserve energy, these heat transfers must add up to 0:</p>
<div class="math notranslate nohighlight">
\[C_1 (T - T_1) + C_2 (T - T_2) = 0\]</div>
<p>We can solve this equation for T:</p>
<div class="math notranslate nohighlight">
\[T = \frac{C_1 T_1 + C_2 T_2}{C_1 + C_2}\]</div>
<p>For the coffee cooling problem, we have the volume of each liquid; if we also know the density, <span class="math notranslate nohighlight">\(\rho\)</span>, and the specific heat capacity, <span class="math notranslate nohighlight">\(c_p\)</span>, we can compute thermal mass:</p>
<div class="math notranslate nohighlight">
\[C = \rho V c_p\]</div>
<p>If the liquids have the same density and heat capacity, they drop out of the equation, and we can write:</p>
<div class="math notranslate nohighlight">
\[T = \frac{V_1 T_1 + V_2 T_2}{V_1 + V_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(V_1\)</span> and <span class="math notranslate nohighlight">\(V_2\)</span> are the volumes of the liquids.</p>
<p>As an approximation, I’ll assume that milk and coffee have the same
density and specific heat. If you are interested, you can look up these
quantities and see how good this assumption is.</p>
<p>Now let’s simulate the mixing process.
The following function takes two <code class="docutils literal notranslate"><span class="pre">System</span></code> objects, representing the
coffee and milk, and creates a new <code class="docutils literal notranslate"><span class="pre">System</span></code> to represent the mixture:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mix</span><span class="p">(</span><span class="n">system1</span><span class="p">,</span> <span class="n">system2</span><span class="p">):</span>
    
    <span class="n">V1</span><span class="p">,</span> <span class="n">V2</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="n">system2</span><span class="o">.</span><span class="n">volume</span>
    <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">T_final</span><span class="p">,</span> <span class="n">system2</span><span class="o">.</span><span class="n">T_final</span>
    
    <span class="n">V_mix</span> <span class="o">=</span> <span class="n">V1</span> <span class="o">+</span> <span class="n">V2</span>
    <span class="n">T_mix</span> <span class="o">=</span> <span class="p">(</span><span class="n">V1</span> <span class="o">*</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">V2</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span> <span class="o">/</span> <span class="n">V_mix</span>
    
    <span class="k">return</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="n">T_mix</span><span class="p">,</span>
                       <span class="n">volume</span><span class="o">=</span><span class="n">V_mix</span><span class="p">,</span>
                       <span class="n">r</span><span class="o">=</span><span class="n">system1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
                       <span class="n">t_end</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The first two lines extract volume and temperature from the <code class="docutils literal notranslate"><span class="pre">System</span></code> objects. The next two lines compute the volume and temperature of the mixture. Finally, <code class="docutils literal notranslate"><span class="pre">mix</span></code> makes a new <code class="docutils literal notranslate"><span class="pre">System</span></code> object and returns it.</p>
<p>This function uses the value of <code class="docutils literal notranslate"><span class="pre">r</span></code> from <code class="docutils literal notranslate"><span class="pre">system1</span></code> as the value of <code class="docutils literal notranslate"><span class="pre">r</span></code>
for the mixture. If <code class="docutils literal notranslate"><span class="pre">system1</span></code> represents the coffee, and we are adding
the milk to the coffee, this is probably a reasonable choice. On the
other hand, when we increase the amount of liquid in the coffee cup,
that might change <code class="docutils literal notranslate"><span class="pre">r</span></code>. So this is an assumption we might want to
revisit.</p>
<p>Now we have everything we need to solve the problem.</p>
</section>
<section id="mix-first-or-last">
<h2>Mix First or Last?<a class="headerlink" href="#mix-first-or-last" title="Link to this heading">#</a></h2>
<p>First I’ll create objects to represent the coffee and milk.
For <code class="docutils literal notranslate"><span class="pre">r_coffee</span></code>, I’ll use the value we computed in the previous chapter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_coffee</span> <span class="o">=</span> <span class="mf">0.0115</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r_coffee</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">r_milk</span></code>, I’ll use the value I estimated in the exercise from the previous chapter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_milk</span> <span class="o">=</span> <span class="mf">0.133</span>
<span class="n">milk</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r_milk</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can mix them and simulate 30 minutes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix_first</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">milk</span><span class="p">)</span>
<span class="n">run_simulation</span><span class="p">(</span><span class="n">mix_first</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>

<span class="n">mix_first</span><span class="o">.</span><span class="n">T_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61.48016207445017
</pre></div>
</div>
</div>
</div>
<p>The final temperature is 61.5 °C which is still warm enough to be
enjoyable. Would we do any better if we added the milk last?</p>
<p>I’ll simulate the coffee and milk separately, and then mix them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_simulation</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>
<span class="n">run_simulation</span><span class="p">(</span><span class="n">milk</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>
<span class="n">mix_last</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">milk</span><span class="p">)</span>
<span class="n">mix_last</span><span class="o">.</span><span class="n">T_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62.91117032872072
</pre></div>
</div>
</div>
</div>
<p>After mixing, the temperature is 62.9 °C, so it looks like adding the
milk at the end is better.
But is that the best we can do?</p>
</section>
<section id="optimal-timing">
<h2>Optimal Timing<a class="headerlink" href="#optimal-timing" title="Link to this heading">#</a></h2>
<p>Adding the milk after 30 minutes is better than adding it immediately, but maybe there’s something in between that’s even better. To find out, I’ll use the following function, which takes the time to add the milk, <code class="docutils literal notranslate"><span class="pre">t_add</span></code>, as a parameter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_and_mix</span><span class="p">(</span><span class="n">t_add</span><span class="p">,</span> <span class="n">t_total</span><span class="p">):</span>
    <span class="n">coffee</span><span class="o">.</span><span class="n">t_end</span> <span class="o">=</span> <span class="n">t_add</span>
    <span class="n">coffee_results</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>
    
    <span class="n">milk</span><span class="o">.</span><span class="n">t_end</span> <span class="o">=</span> <span class="n">t_add</span>
    <span class="n">milk_results</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">milk</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>
    
    <span class="n">mixture</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">milk</span><span class="p">)</span>
    <span class="n">mixture</span><span class="o">.</span><span class="n">t_end</span> <span class="o">=</span> <span class="n">t_total</span> <span class="o">-</span> <span class="n">t_add</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">mixture</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mixture</span><span class="o">.</span><span class="n">T_final</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">run_and_mix</span></code> simulates both systems for the given time, <code class="docutils literal notranslate"><span class="pre">t_add</span></code>.
Then it mixes them and simulates the mixture for the remaining time, <code class="docutils literal notranslate"><span class="pre">t_total</span> <span class="pre">-</span> <span class="pre">t_add</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">t_add</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, we add the milk immediately; when <code class="docutils literal notranslate"><span class="pre">t_add</span></code> is <code class="docutils literal notranslate"><span class="pre">30</span></code>, we add it at the end. Now we can sweep the range of values in between:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sweep</span> <span class="o">=</span> <span class="n">SweepSeries</span><span class="p">()</span>
<span class="k">for</span> <span class="n">t_add</span> <span class="ow">in</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">sweep</span><span class="p">[</span><span class="n">t_add</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_and_mix</span><span class="p">(</span><span class="n">t_add</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what the results look like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sweep</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mixture&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time until mixing (min)&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Final temperature (C)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a8d17a812826e3a8a662b9395c22eeaf16dbd5f087bb957c8f2150c0c9600cd8.png" src="_images/a8d17a812826e3a8a662b9395c22eeaf16dbd5f087bb957c8f2150c0c9600cd8.png" />
</div>
</div>
<p>Note that this is a parameter sweep, not a time series.</p>
<p>The final temperature is maximized when <code class="docutils literal notranslate"><span class="pre">t_add=30</span></code>, so adding the milk
at the end is optimal.</p>
</section>
<section id="analytic-solution">
<h2>Analytic Solution<a class="headerlink" href="#analytic-solution" title="Link to this heading">#</a></h2>
<p>Simulating Newton’s law of cooling isn’t really necessary because we can solve the differential equation analytically. If</p>
<div class="math notranslate nohighlight">
\[\frac{dT}{dt} = -r (T - T_{env})\]</div>
<p>the general solution is</p>
<div class="math notranslate nohighlight">
\[T{\left (t \right )} = C \exp(-r t) + T_{env}\]</div>
<p>and the particular solution where <span class="math notranslate nohighlight">\(T(0) = T_{init}\)</span> is</p>
<div class="math notranslate nohighlight">
\[T_{env} + \left(- T_{env} + T_{init}\right) \exp(-r t)\]</div>
<p>If you would like to see this solution done by hand, you can watch this video: <a class="reference external" href="http://modsimpy.com/khan3">http://modsimpy.com/khan3</a>.</p>
<p>Now we can use the observed data to estimate the parameter <span class="math notranslate nohighlight">\(r\)</span>. If we
observe the that the temperature at <span class="math notranslate nohighlight">\(t_{end}\)</span> is <span class="math notranslate nohighlight">\(T_{final}\)</span>, we can plug these values into the particular solution and solve for <span class="math notranslate nohighlight">\(r\)</span>. The result is:</p>
<div class="math notranslate nohighlight">
\[r = \frac{1}{t_{end}} \log{\left (\frac{T_{init} - T_{env}}{T_{final} - T_{env}} \right )}\]</div>
<p>The following function takes a <code class="docutils literal notranslate"><span class="pre">System</span></code> object and computes <code class="docutils literal notranslate"><span class="pre">r</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">compute_r</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
    <span class="n">t_end</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">t_end</span>
    <span class="n">T_init</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">T_init</span>
    <span class="n">T_final</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">T_final</span>
    <span class="n">T_env</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">T_env</span>
    
    <span class="n">r</span> <span class="o">=</span> <span class="n">log</span><span class="p">((</span><span class="n">T_init</span> <span class="o">-</span> <span class="n">T_env</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">T_final</span> <span class="o">-</span> <span class="n">T_env</span><span class="p">))</span> <span class="o">/</span> <span class="n">t_end</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>We can use this function to compute <code class="docutils literal notranslate"><span class="pre">r</span></code> for the coffee, given the parameters of the problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee2</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">coffee2</span><span class="o">.</span><span class="n">T_final</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">r_coffee2</span> <span class="o">=</span> <span class="n">compute_r</span><span class="p">(</span><span class="n">coffee2</span><span class="p">)</span>
<span class="n">r_coffee2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01161022314227386
</pre></div>
</div>
</div>
</div>
<p>This value is close to the value of <code class="docutils literal notranslate"><span class="pre">r</span></code> we computed in the previous chapter, <code class="docutils literal notranslate"><span class="pre">0.115</span></code>, but not exactly the same.
That’s because the simulations use discrete time steps, and the analysis uses continuous time.</p>
<p>Nevertheless, the results of the analysis are consistent with the simulation.
To check, we’ll use the following function, which takes a <code class="docutils literal notranslate"><span class="pre">System</span></code> object and uses the analytic result to compute a time series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span>

<span class="k">def</span> <span class="nf">run_analysis</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
    <span class="n">T_env</span><span class="p">,</span> <span class="n">T_init</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">T_env</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">T_init</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">r</span>
    
    <span class="n">t_array</span> <span class="o">=</span> <span class="n">linrange</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">t_0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">t_end</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>    
    <span class="n">T_array</span> <span class="o">=</span> <span class="n">T_env</span> <span class="o">+</span> <span class="p">(</span><span class="n">T_init</span> <span class="o">-</span> <span class="n">T_env</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">t_array</span><span class="p">)</span>
    
    <span class="n">system</span><span class="o">.</span><span class="n">T_final</span> <span class="o">=</span> <span class="n">T_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">make_series</span><span class="p">(</span><span class="n">t_array</span><span class="p">,</span> <span class="n">T_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The first line unpacks the system variables.
The next two lines compute <code class="docutils literal notranslate"><span class="pre">t_array</span></code>, which is a NumPy array of time stamps, and <code class="docutils literal notranslate"><span class="pre">T_array</span></code>, which is an array of the corresponding temperatures.
The last two lines store the final temperature in the <code class="docutils literal notranslate"><span class="pre">System</span></code> object and use <code class="docutils literal notranslate"><span class="pre">make_series</span></code> to return the results in a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>We can run it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee2</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r_coffee2</span>
<span class="n">results2</span> <span class="o">=</span> <span class="n">run_analysis</span><span class="p">(</span><span class="n">coffee2</span><span class="p">)</span>
<span class="n">coffee2</span><span class="o">.</span><span class="n">T_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>70.0
</pre></div>
</div>
</div>
</div>
<p>The final temperature is 70 °C, as it should be. In fact, the results
are identical to what we got by simulation, with a small difference due to rounding.</p>
<p>Since we can solve this problem analytically, you might wonder why we bothered writing a simulation.
One reason is validation: since we solved the same problem two ways, we can be more confident that the answer is correct.
The other reason is flexibility: now that we have a working simulation, it would be easy to add more features. For example, the temperature of the environment might change over time, or we could simulate the coffee and container as two objects.
If the coffee and milk are next to each other, we could include the heat flow between them. A model with these features would be difficult or impossible to solve analytically.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this chapter we finished the coffee cooling problem from the previous chapter, and found that it is better to add the milk at the end, at least for the version of the problem I posed.</p>
<p>As an exercise you will have a chance to explore a variation of the problem where the answer might be different.</p>
<p>In the next chapter we’ll move on to a new example, a model of how glucose and insulin interact to control blood sugar.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
You can access the notebooks at <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">compute_r</span></code> to compute <code class="docutils literal notranslate"><span class="pre">r_milk</span></code> according to the analytic solution.  Run the analysis with this value of <code class="docutils literal notranslate"><span class="pre">r_milk</span></code> and confirm that the results are consistent with the simulation.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">milk2</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">milk2</span><span class="o">.</span><span class="n">T_final</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">r_milk2</span> <span class="o">=</span> <span class="n">compute_r</span><span class="p">(</span><span class="n">milk2</span><span class="p">)</span>
<span class="n">r_milk2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.14267107756641806
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">milk2</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r_milk2</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">results2</span> <span class="o">=</span> <span class="n">run_analysis</span><span class="p">(</span><span class="n">milk2</span><span class="p">)</span>
<span class="n">milk2</span><span class="o">.</span><span class="n">T_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.0
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">milk</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span><span class="n">T_init</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.13296</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">milk</span><span class="p">,</span> <span class="n">change_func</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">allclose</span>

<span class="n">allclose</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>Suppose the coffee shop won’t let me take milk in a separate container, but I keep a bottle of milk in the refrigerator at my office.  In that case is it better to add the milk at the coffee shop, or wait until I get to the office?</p>
<p>Hint: Think about the simplest way to represent the behavior of a refrigerator in this model.  The change you make to test this variation of the problem should be very small!</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># A refrigerator keeps the milk at a constant temperature,</span>
<span class="c1"># so it is like a container with r = 0.</span>

<span class="c1"># With T_init=5 and r_milk = 0, </span>
<span class="c1"># it is best to add the milk at the beginning.</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap15.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cooling Coffee</p>
      </div>
    </a>
    <a class="right-next"
       href="chap17.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Pharmacokinetics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-liquids">Mixing Liquids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mix-first-or-last">Mix First or Last?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimal-timing">Optimal Timing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytic-solution">Analytic Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>