
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Torque &#8212; Modeling and Simulation in Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case Studies Part 3" href="chap26.html" />
    <link rel="prev" title="Rotation" href="chap24.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Modeling and Simulation in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Modeling and Simulation in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap01.html">
   Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap02.html">
   Bike Share System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap03.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap04.html">
   Sweeping Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap05.html">
   World Population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap06.html">
   Proportional Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap07.html">
   Limits to Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap08.html">
   Projecting Population Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap09.html">
   Analysis of Population Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Case Studies Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Epidemiology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Modeling Vaccination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Sweeping Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap14.html">
   Nondimensionalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Cooling Coffee
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap16.html">
   Adding Milk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap17.html">
   Pharmacokinetics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap18.html">
   Glucose and Insulin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap19.html">
   Case Studies Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap20.html">
   The Empire State Building Strikes Back
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap21.html">
   Drag
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap22.html">
   Baseball
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap23.html">
   Optimal Baseball
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap24.html">
   Rotation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Torque
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap26.html">
   Case Studies Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap27.html">
   Under the Hood
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="queue.html">
   One Queue or Two
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AllenDowney/ModSimPy/master?urlpath=tree/chap25.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/AllenDowney/ModSimPy"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/chap25.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angular-acceleration">
   Angular Acceleration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#moment-of-inertia">
   Moment of Inertia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#teapots-and-turntables">
   Teapots and Turntables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-phase-simulation">
   Two Phase Simulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-1">
     Phase 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-2">
     Phase 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combining-the-results">
     Combining the Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-friction">
   Estimating Friction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#animating-the-turntable">
   Animating the Turntable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Torque</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angular-acceleration">
   Angular Acceleration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#moment-of-inertia">
   Moment of Inertia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#teapots-and-turntables">
   Teapots and Turntables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-phase-simulation">
   Two Phase Simulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-1">
     Phase 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-2">
     Phase 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combining-the-results">
     Combining the Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-friction">
   Estimating Friction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#animating-the-turntable">
   Animating the Turntable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="torque">
<h1>Torque<a class="headerlink" href="#torque" title="Permalink to this headline">#</a></h1>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
Click here to access the notebooks: <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<p>In the previous chapter we modeled a system with constant angular
velocity.
In this chapter we take the next step, modeling a system with angular acceleration and deceleration.</p>
<section id="angular-acceleration">
<h2>Angular Acceleration<a class="headerlink" href="#angular-acceleration" title="Permalink to this headline">#</a></h2>
<p>Just as linear acceleration is the derivative of velocity, <em>angular
acceleration</em> is the derivative of angular velocity. And just as linear acceleration is caused by force, angular acceleration is caused by the rotational version of force, <em>torque</em>. If you are not familiar with torque, you can read about it at <a class="reference external" href="http://modsimpy.com/torque">http://modsimpy.com/torque</a>.</p>
<p>In general, torque is a vector quantity, defined as the <em>cross
product</em> of <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}\)</span>, where <span class="math notranslate nohighlight">\(\vec{r}\)</span> is the <em>lever
arm</em>, a vector from the center of rotation to the point where the force is applied, and <span class="math notranslate nohighlight">\(\vec{F}\)</span> is the vector that represents the magnitude and direction of the force.</p>
<p>For the problems in this chapter, however, we only need the <em>magnitude</em> of torque; we don’t care about the direction. In that case, we can compute this product of scalar quantities:</p>
<div class="math notranslate nohighlight">
\[\tau = r F \sin \theta\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is torque, <span class="math notranslate nohighlight">\(r\)</span> is the length of the lever arm, <span class="math notranslate nohighlight">\(F\)</span> is the magnitude of force, and <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}\)</span>.</p>
<p>Since torque is the product of a length and a force, it is expressed in newton meters (Nm).</p>
</section>
<section id="moment-of-inertia">
<h2>Moment of Inertia<a class="headerlink" href="#moment-of-inertia" title="Permalink to this headline">#</a></h2>
<p>In the same way that linear acceleration is related to force by Newton’s second law of motion, <span class="math notranslate nohighlight">\(F=ma\)</span>, angular acceleration is related to torque by another form of Newton’s law:</p>
<div class="math notranslate nohighlight">
\[\tau = I \alpha\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is angular acceleration and <span class="math notranslate nohighlight">\(I\)</span> is <em>moment of inertia</em>. Just as mass is what makes it hard to accelerate an object, moment of inertia is what makes it hard to spin an object.</p>
<p>In the most general case, a 3-D object rotating around an arbitrary
axis, moment of inertia is a <em>tensor</em>, which is a function that takes a
vector as a parameter and returns a vector as a result.</p>
<p>Fortunately, in a system where all rotation and torque happens around a single axis, we don’t have to deal with the most general case. We can treat moment of inertia as a scalar quantity.</p>
<p>For a small object with mass <span class="math notranslate nohighlight">\(m\)</span>, rotating around a point at distance
<span class="math notranslate nohighlight">\(r\)</span>, the moment of inertia is <span class="math notranslate nohighlight">\(I = m r^2\)</span>. For more complex objects, we can compute <span class="math notranslate nohighlight">\(I\)</span> by dividing the object into small masses, computing
moments of inertia for each mass, and adding them up.
For most simple shapes, people have already done the
calculations; you can just look up the answers. For example, see
<a class="reference external" href="http://modsimpy.com/moment">http://modsimpy.com/moment</a>.</p>
</section>
<section id="teapots-and-turntables">
<h2>Teapots and Turntables<a class="headerlink" href="#teapots-and-turntables" title="Permalink to this headline">#</a></h2>
<p>Tables in Chinese restaurants often have a rotating tray or turntable
that makes it easy for customers to share dishes. These turntables are
supported by low-friction bearings that allow them to turn easily and
glide. However, they can be heavy, especially when they are loaded with food, so they have a high moment of inertia.</p>
<p>Suppose I am sitting at a table with a pot of tea on the turntable
directly in front of me, and the person sitting directly opposite asks
me to pass the tea. I push on the edge of the turntable with 2 N of
force until it has turned 0.5 rad, then let go. The turntable glides
until it comes to a stop 1.5 rad from the starting position. How much
force should I apply for a second push so the teapot glides to a stop
directly opposite me?</p>
<p>We’ll answer this question in these steps:</p>
<ol class="simple">
<li><p>I’ll use the results from the first push to estimate the coefficient of friction for the turntable.</p></li>
<li><p>As an exercise, you’ll use that coefficient of friction to estimate the force needed to rotate the turntable through the remaining angle.</p></li>
</ol>
<p>Our simulation will use the following parameters:</p>
<ol class="simple">
<li><p>The radius of the turntable is 0.5 m, and its weight is 7 kg.</p></li>
<li><p>The teapot weights 0.3 kg, and it sits 0.4 m from the center of the turntable.</p></li>
</ol>
<p>The following figure shows the scenario, where <span class="math notranslate nohighlight">\(F\)</span> is the force I apply to the turntable at the perimeter, perpendicular to the lever arm, <span class="math notranslate nohighlight">\(r\)</span>, and <span class="math notranslate nohighlight">\(\tau\)</span> is the resulting torque. The  circle near the bottom is the teapot.</p>
<p><img alt="Diagram of a turntable with ateapot." src="https://github.com/AllenDowney/ModSim/raw/main/figs/teapot.png" /></p>
<p>Here are the parameters from the statement of the problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">radius_disk</span> <span class="o">=</span> <span class="mf">0.5</span>     <span class="c1"># m</span>
<span class="n">mass_disk</span> <span class="o">=</span> <span class="mi">7</span>         <span class="c1"># kg</span>
<span class="n">radius_pot</span> <span class="o">=</span> <span class="mf">0.4</span>      <span class="c1"># m</span>
<span class="n">mass_pot</span> <span class="o">=</span> <span class="mf">0.3</span>        <span class="c1"># kg</span>
<span class="n">force</span> <span class="o">=</span> <span class="mi">2</span>             <span class="c1"># N</span>

<span class="n">theta_push</span> <span class="o">=</span> <span class="mf">0.5</span>        <span class="c1"># radian</span>
<span class="n">theta_test</span> <span class="o">=</span> <span class="mf">1.5</span>        <span class="c1"># radian</span>
<span class="n">theta_target</span> <span class="o">=</span> <span class="n">pi</span>       <span class="c1"># radian</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">theta_push</span></code> is the angle where I stop pushing on the turntable.
<code class="docutils literal notranslate"><span class="pre">theta_test</span></code> is how far the table turns during my test push.
<code class="docutils literal notranslate"><span class="pre">theta_target</span></code> is where we want the table to be after the second push.</p>
<p>We can use these parameters to compute the moment of inertia of the turntable, using the formula for a horizontal disk revolving around a vertical axis through its center:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_disk</span> <span class="o">=</span> <span class="n">mass_disk</span> <span class="o">*</span> <span class="n">radius_disk</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>We can also compute the moment of inertia of the teapot, treating it as a point mass:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_pot</span> <span class="o">=</span> <span class="n">mass_pot</span> <span class="o">*</span> <span class="n">radius_pot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>The total moment of inertia is the sum of these parts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I_total</span> <span class="o">=</span> <span class="n">I_disk</span> <span class="o">+</span> <span class="n">I_pot</span>
</pre></div>
</div>
</div>
</div>
<p>Friction in the bearings probably depends on the weight of the turntable and its contents, but probably does not depend on angular velocity.
So we’ll assume that it is a constant.
We don’t know what it is, so I will start with a guess, and we will use <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> to improve it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torque_friction</span> <span class="o">=</span> <span class="mf">0.3</span>   <span class="c1"># N*m</span>
</pre></div>
</div>
</div>
</div>
<p>For this problem we’ll treat friction as a torque.</p>
<p>The state variables we’ll use are <code class="docutils literal notranslate"><span class="pre">theta</span></code>, which is the angle of the table in rad, and <code class="docutils literal notranslate"><span class="pre">omega</span></code>, which is angular velocity in rad/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can make a <code class="docutils literal notranslate"><span class="pre">System</span></code> with the initial state, <code class="docutils literal notranslate"><span class="pre">init</span></code>, the maximum duration of the simulation, <code class="docutils literal notranslate"><span class="pre">t_end</span></code>, and the parameters we are going to vary, <code class="docutils literal notranslate"><span class="pre">force</span></code> and <code class="docutils literal notranslate"><span class="pre">torque_friction</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> 
                <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
                <span class="n">torque_friction</span><span class="o">=</span><span class="n">torque_friction</span><span class="p">,</span>
                <span class="n">t_end</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a slope function that takes the current state, which contains angle and angular velocity, and returns the derivatives, angular velocity and angular acceleration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slope_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">force</span>
    <span class="n">torque_friction</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">torque_friction</span>
    
    <span class="n">torque</span> <span class="o">=</span> <span class="n">radius_disk</span> <span class="o">*</span> <span class="n">force</span> <span class="o">-</span> <span class="n">torque_friction</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">torque</span> <span class="o">/</span> <span class="n">I_total</span>
    
    <span class="k">return</span> <span class="n">omega</span><span class="p">,</span> <span class="n">alpha</span> 
</pre></div>
</div>
</div>
</div>
<p>In this scenario, the force I apply to the turntable is always
perpendicular to the lever arm, so <span class="math notranslate nohighlight">\(\sin \theta = 1\)</span> and the torque due
to force is <span class="math notranslate nohighlight">\(\tau = r F\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">torque_friction</span></code> represents the torque due to friction. Because the
turntable is rotating in the direction of positive <code class="docutils literal notranslate"><span class="pre">theta</span></code>, friction
acts in the direction of negative <code class="docutils literal notranslate"><span class="pre">theta</span></code>.</p>
<p>We can test the slope function with the initial conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0.7583965330444203)
</pre></div>
</div>
</div>
</div>
<p>We are almost ready to run the simulation, but first there’s a problem we have to address.</p>
</section>
<section id="two-phase-simulation">
<h2>Two Phase Simulation<a class="headerlink" href="#two-phase-simulation" title="Permalink to this headline">#</a></h2>
<p>When I stop pushing on the turntable, the angular acceleration changes
abruptly. We could implement the slope function with an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement
that checks the value of <code class="docutils literal notranslate"><span class="pre">theta</span></code> and sets <code class="docutils literal notranslate"><span class="pre">force</span></code> accordingly. And for a coarse model like this one, that might be fine. But a more robust approach is to simulate the system in two phases:</p>
<ol class="simple">
<li><p>During the first phase, force is constant, and we run until <code class="docutils literal notranslate"><span class="pre">theta</span></code> is 0.5 radians.</p></li>
<li><p>During the second phase, force is 0, and we run until <code class="docutils literal notranslate"><span class="pre">omega</span></code> is 0.</p></li>
</ol>
<p>Then we can combine the results of the two phases into a single
<code class="docutils literal notranslate"><span class="pre">TimeFrame</span></code>.</p>
<section id="phase-1">
<h3>Phase 1<a class="headerlink" href="#phase-1" title="Permalink to this headline">#</a></h3>
<p>Here’s the event function I’ll use for Phase 1; it stops the simulation when <code class="docutils literal notranslate"><span class="pre">theta</span></code> reaches <code class="docutils literal notranslate"><span class="pre">theta_push</span></code>, which is when I stop pushing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">event_func1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">theta_push</span>
</pre></div>
</div>
</div>
</div>
<p>We can test it with the initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_func1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5
</pre></div>
</div>
</div>
</div>
<p>And run the first phase of the simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results1</span><span class="p">,</span> <span class="n">details1</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span>
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func1</span><span class="p">)</span>
<span class="n">details1</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</div>
<p>Here are the last few time steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results1</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.102359</th>
      <td>0.46080</td>
      <td>0.836025</td>
    </tr>
    <tr>
      <th>1.113842</th>
      <td>0.47045</td>
      <td>0.844734</td>
    </tr>
    <tr>
      <th>1.125325</th>
      <td>0.48020</td>
      <td>0.853442</td>
    </tr>
    <tr>
      <th>1.136808</th>
      <td>0.49005</td>
      <td>0.862151</td>
    </tr>
    <tr>
      <th>1.148291</th>
      <td>0.50000</td>
      <td>0.870860</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It takes a little more than a second for me to rotate the table 0.5 rad.
When I release the table, the angular velocity is about 0.87 rad / s.</p>
<p>Before we run the second phase, we have to extract the final time and
state of the first phase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">init2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="phase-2">
<h3>Phase 2<a class="headerlink" href="#phase-2" title="Permalink to this headline">#</a></h3>
<p>Now we can make a <code class="docutils literal notranslate"><span class="pre">System</span></code> object for Phase 2 with the initial state
from Phase 1 and with <code class="docutils literal notranslate"><span class="pre">force=0</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system2</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">t_2</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init2</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the second phase, we need an event function that stops when the
turntable stops; that is, when angular velocity is 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">event_func2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">return</span> <span class="n">omega</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll test it with the initial conditions for Phase 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_func2</span><span class="p">(</span><span class="n">system2</span><span class="o">.</span><span class="n">t_0</span><span class="p">,</span> <span class="n">system2</span><span class="o">.</span><span class="n">init</span><span class="p">,</span> <span class="n">system2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8708596517490182
</pre></div>
</div>
</div>
</div>
<p>The result is the angular velocity at the beginning of Phase 2, in rad/s.</p>
<p>Now we can run the second phase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results2</span><span class="p">,</span> <span class="n">details2</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system2</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span>
                                   <span class="n">events</span><span class="o">=</span><span class="n">event_func2</span><span class="p">)</span>
<span class="n">details2</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A termination event occurred.&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="combining-the-results">
<h3>Combining the Results<a class="headerlink" href="#combining-the-results" title="Permalink to this headline">#</a></h3>
<p>Pandas provides a function called <code class="docutils literal notranslate"><span class="pre">concat</span></code>, which makes a
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with the rows from <code class="docutils literal notranslate"><span class="pre">results1</span></code> followed by the rows from <code class="docutils literal notranslate"><span class="pre">results2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Here are the last few time steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3.720462</th>
      <td>1.664800</td>
      <td>3.483439e-02</td>
    </tr>
    <tr>
      <th>3.747255</th>
      <td>1.665617</td>
      <td>2.612579e-02</td>
    </tr>
    <tr>
      <th>3.774049</th>
      <td>1.666200</td>
      <td>1.741719e-02</td>
    </tr>
    <tr>
      <th>3.800842</th>
      <td>1.666550</td>
      <td>8.708597e-03</td>
    </tr>
    <tr>
      <th>3.827636</th>
      <td>1.666667</td>
      <td>-2.220446e-16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>At the end, angular velocity is close to 0, and the total rotation is about 1.7 rad, a little farther than we were aiming for.</p>
<p>We can plot <code class="docutils literal notranslate"><span class="pre">theta</span></code> for both phases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Angle (rad)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_52_0.png" src="_images/chap25_52_0.png" />
</div>
</div>
<p>And <code class="docutils literal notranslate"><span class="pre">omega</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">omega</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;omega&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Angular velocity (rad/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_54_0.png" src="_images/chap25_54_0.png" />
</div>
</div>
<p>Angular velocity, <code class="docutils literal notranslate"><span class="pre">omega</span></code>, increases linearly while I am pushing, and decreases linearly after I let go. The angle, <code class="docutils literal notranslate"><span class="pre">theta</span></code>, is the integral of angular velocity, so it forms a parabola during each phase.</p>
<p>In the next section, we’ll use this simulation to estimate the torque
due to friction.</p>
</section>
</section>
<section id="estimating-friction">
<h2>Estimating Friction<a class="headerlink" href="#estimating-friction" title="Permalink to this headline">#</a></h2>
<p>Let’s take the code from the previous section and wrap it in a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    
    <span class="c1"># put the specified parameters into the System object</span>
    <span class="n">system1</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span> 
                         <span class="n">torque_friction</span><span class="o">=</span><span class="n">torque_friction</span><span class="p">)</span>

    <span class="c1"># run phase 1</span>
    <span class="n">results1</span><span class="p">,</span> <span class="n">details1</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system1</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                       <span class="n">events</span><span class="o">=</span><span class="n">event_func1</span><span class="p">)</span>

    <span class="c1"># get the final state from phase 1</span>
    <span class="n">t_2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">init2</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># run phase 2</span>
    <span class="n">system2</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">t_0</span><span class="o">=</span><span class="n">t_2</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init2</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">results2</span><span class="p">,</span> <span class="n">details2</span> <span class="o">=</span> <span class="n">run_solve_ivp</span><span class="p">(</span><span class="n">system2</span><span class="p">,</span> <span class="n">slope_func</span><span class="p">,</span> 
                                       <span class="n">events</span><span class="o">=</span><span class="n">event_func2</span><span class="p">)</span>
    
    <span class="c1"># combine and return the results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<p>I’ll test it with the same parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">force</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">torque_friction</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
      <th>omega</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3.720462</th>
      <td>1.664800</td>
      <td>3.483439e-02</td>
    </tr>
    <tr>
      <th>3.747255</th>
      <td>1.665617</td>
      <td>2.612579e-02</td>
    </tr>
    <tr>
      <th>3.774049</th>
      <td>1.666200</td>
      <td>1.741719e-02</td>
    </tr>
    <tr>
      <th>3.800842</th>
      <td>1.666550</td>
      <td>8.708597e-03</td>
    </tr>
    <tr>
      <th>3.827636</th>
      <td>1.666667</td>
      <td>-2.220446e-16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These results are the same as in the previous section.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">run_two_phases</span></code> to write an error function we can use, with <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>, to find the torque due to friction that yields the
observed results from the first push, a total rotation of 1.5 rad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">error_func1</span><span class="p">(</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="n">force</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">force</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
    <span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">theta_final</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_final</span> <span class="o">-</span> <span class="n">theta_test</span>
</pre></div>
</div>
</div>
</div>
<p>This error function takes torque due to friction as an input.
It extracts <code class="docutils literal notranslate"><span class="pre">force</span></code> from the <code class="docutils literal notranslate"><span class="pre">System</span></code> object and runs the simulation.
From the results, it extracts the last value of <code class="docutils literal notranslate"><span class="pre">theta</span></code> and returns the difference between the result of the simulation and the result of the experiment.
When this difference is 0, the value of <code class="docutils literal notranslate"><span class="pre">torque_friction</span></code> is an estimate for the friction in the experiment.</p>
<p>To bracket the root, we need one value that’s too low and one that’s too high.
With <code class="docutils literal notranslate"><span class="pre">torque_friction=0.3</span></code>, the table rotates a bit too far:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guess1</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">error_func1</span><span class="p">(</span><span class="n">guess1</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 1.666666666666669
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.16666666666666896
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">torque_friction=0.4</span></code>, it doesn’t go far enough.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guess2</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">error_func1</span><span class="p">(</span><span class="n">guess2</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4 1.2499999999999996
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.25000000000000044
</pre></div>
</div>
</div>
</div>
<p>So we can use those two values as a bracket for <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">error_func1</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">[</span><span class="n">guess1</span><span class="p">,</span> <span class="n">guess2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 1.666666666666669
0.3 1.666666666666669
0.4 1.2499999999999996
0.3400000000000003 1.4705882352941169
0.3340000000000002 1.4970059880239517
0.3333320000000001 1.5000060000239976
0.3333486666010001 1.4999310034693254
</pre></div>
</div>
</div>
</div>
<p>The result is 0.333 N m, a little less than the initial guess.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">actual_friction</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">root</span>
<span class="n">actual_friction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3333320000000001
</pre></div>
</div>
</div>
</div>
<p>Now that we know the torque due to friction, we can compute the force
needed to rotate the turntable through the remaining angle, that is,
from 1.5 rad to 3.14 rad.
You’ll have a chance to do that as an exercise, but first, let’s animate the results.</p>
</section>
<section id="animating-the-turntable">
<h2>Animating the Turntable<a class="headerlink" href="#animating-the-turntable" title="Permalink to this headline">#</a></h2>
<p>Here’s a function that takes the state of the system and draws it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">gca</span><span class="p">,</span> <span class="n">axis</span>

<span class="k">def</span> <span class="nf">draw_func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">state</span>
    
    <span class="c1"># draw a circle for the table</span>
    <span class="n">circle1</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">radius_disk</span><span class="p">)</span>
    <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle1</span><span class="p">)</span>
    
    <span class="c1"># draw a circle for the teapot</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">radius_pot</span><span class="p">)</span>
    <span class="n">circle2</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
    <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle2</span><span class="p">)</span>

    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function uses a few features we have not seen before, but you can read about them in the Matplotlib documentation.</p>
<p>Here’s what the initial condition looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">draw_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap25_74_0.png" src="_images/chap25_74_0.png" />
</div>
</div>
<p>And here’s how we call it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># animate(results, draw_func)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>The example in this chapter demonstrates the concepts of torque, angular acceleration, and moment of inertia.
We used these concepts to simulate a turntable, using a hypothetical observation to estimate torque due to friction.
As an exercise, you can finish off the example, estimating the force needed to rotate the table to a given target angle.</p>
<p>The next chapter describes several case studies you can work on to practice the tools from the last few chapters, including projectiles, rotating objects, <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code>, and <code class="docutils literal notranslate"><span class="pre">maximize_scalar</span></code>.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p>This chapter is available as a Jupyter notebook where you can read the text, run the code, and work on the exercises.
You can access the notebooks at <a class="reference external" href="https://allendowney.github.io/ModSimPy/">https://allendowney.github.io/ModSimPy/</a>.</p>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">#</a></h3>
<p>Continuing the example from this chapter, estimate the force that delivers the teapot to the desired position.
Use this <code class="docutils literal notranslate"><span class="pre">System</span></code> object, with the friction we computed in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system3</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">torque_friction</span><span class="o">=</span><span class="n">actual_friction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Write an error function that takes <code class="docutils literal notranslate"><span class="pre">force</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>, simulates the system, and returns the difference between <code class="docutils literal notranslate"><span class="pre">theta_final</span></code> and the remaining angle after the first push.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remaining_angle</span> <span class="o">=</span> <span class="n">theta_target</span> <span class="o">-</span> <span class="n">theta_test</span>
<span class="n">remaining_angle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6415926535897931
</pre></div>
</div>
</div>
</div>
<p>Use your error function and <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> to find the force needed for the second push.
Run the simulation with the force you computed and confirm that the table stops at the target angle after both pushes.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="k">def</span> <span class="nf">error_func2</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error function for root_scalar.</span>
<span class="sd">    </span>
<span class="sd">    force: hypothetical value</span>
<span class="sd">    </span>
<span class="sd">    returns: offset from target value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">torque_friction</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
    <span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">theta_final</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_final</span> <span class="o">-</span> <span class="n">remaining_angle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">guess1</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">error_func2</span><span class="p">(</span><span class="n">guess1</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0 1.5000060000239976
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.14158665356579547
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">guess2</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">error_func2</span><span class="p">(</span><span class="n">guess2</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0 2.250009000035999
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.608416346446206
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">error_func2</span><span class="p">,</span> <span class="n">system3</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">[</span><span class="n">guess1</span><span class="p">,</span> <span class="n">guess2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0 1.5000060000239976
2.0 1.5000060000239976
3.0 2.250009000035999
2.1887814496255746 1.641592653589789
2.188890888699056 1.6416747332232227
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">force</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">root</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_two_phases</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">actual_friction</span><span class="p">,</span> <span class="n">system3</span><span class="p">)</span>
<span class="n">theta_final</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
<span class="n">theta_final</span> <span class="o">+</span> <span class="n">theta_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897887
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">theta_target</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chap24.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Rotation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chap26.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Case Studies Part 3</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Allen B. Downey<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>